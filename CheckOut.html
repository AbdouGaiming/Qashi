<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="Style/CheckOutStyle.css">
    <script defer src="Script/CheckOut.js"></script>
    <div class="top-border">
        <a id="Logo" href="index.html"><img class="img" src="ICONS/Qashi.png"></a>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>
    <div class="row">
        <div class="col-75">
            <div class="container">
                <form id="FormCheckOut" action="/action_page.php">
                    <div class="row">
                        <div class="col-50">
                            <h3>Billing Address</h3>
                            <label for="fname"><i class="fa fa-user"></i> Full Name</label>
                            <input type="text" id="fname" required name="firstname" placeholder="Fullname">
                            <label id="I-fullname">Please enter a valide name</label>
                            <label for="email"><i class="fa fa-envelope"></i> Phone</label>
                            <input type="text" required id="phone" name="phone">
                            <label id="I-phone">Please enter a valide phone number</label>
                            <label for="adr"><i class="fa fa-address-card-o"></i> Address</label>
                            <input type="text" required id="adr" name="address">
                            <label id="I-address">Please enter a valide address</label>
                            <label for="wilaya">Wilaya</label>
                            <select id="wilaya" required name="wilaya">
                                <option disabled selected value>-- Select Wilaya --</option>
                                <option value="Adrar">01 - Adrar</option>
                                <option value="Chlef">02 - Chlef</option>
                                <option value="Laghouat">03 - Laghouat</option>
                                <option value="Oum El Bouaghi">04 - Oum El Bouaghi</option>
                                <option value="Batna">05 - Batna</option>
                                <option value="Bejaia">06 - Bejaia</option>
                                <option value="Biskra">07 - Biskra</option>
                                <option value="Bechar">08 - Bechar</option>
                                <option value="Blida">09 - Blida</option>
                                <option value="Bouira">10 - Bouira</option>
                                <option value="Tamanrasset">11 - Tamanrasset</option>
                                <option value="Tebessa">12 - Tebessa</option>
                                <option value="Tlemcen">13 - Tlemcen</option>
                                <option value="Tiaret">14 - Tiaret</option>
                                <option value="Tizi Ouzou">15 - Tizi Ouzou</option>
                                <option value="Algiers">16 - Algiers</option>
                                <option value="Djelfa">17 - Djelfa</option>
                                <option value="Jijel">18 - Jijel</option>
                                <option value="Setif">19 - Setif</option>
                                <option value="Saida">20 - Saida</option>
                                <option value="Skikda">21 - Skikda</option>
                                <option value="Sidi Bel Abbes">22 - Sidi Bel Abbes</option>
                                <option value="Annaba">23 - Annaba</option>
                                <option value="Guelma">24 - Guelma</option>
                                <option value="Constantine">25 - Constantine</option>
                                <option value="Medea">26 - Medea</option>
                                <option value="Mostaganem">27 - Mostaganem</option>
                                <option value="M'Sila">28 - M'Sila</option>
                                <option value="Mascara">29 - Mascara</option>
                                <option value="Ouargla">30 - Ouargla</option>
                                <option value="Oran">31 - Oran</option>
                                <option value="El Bayadh">32 - El Bayadh</option>
                                <option value="Illizi">33 - Illizi</option>
                                <option value="Bordj Bou Arreridj">34 - Bordj Bou Arreridj</option>
                                <option value="Boumerdes">35 - Boumerdes</option>
                                <option value="El Tarf">36 - El Tarf</option>
                                <option value="Tindouf">37 - Tindouf</option>
                                <option value="Tissemsilt">38 - Tissemsilt</option>
                                <option value="El Oued">39 - El Oued</option>
                                <option value="Khenchela">40 - Khenchela</option>
                                <option value="Souk Ahras">41 - Souk Ahras</option>
                                <option value="Tipaza">42 - Tipaza</option>
                                <option value="Mila">43 - Mila</option>
                                <option value="Ain Defla">44 - Ain Defla</option>
                                <option value="Naama">45 - Naama</option>
                                <option value="Ain Temouchent">46 - Ain Temouchent</option>
                                <option value="Ghardaia">47 - Ghardaia</option>
                                <option value="Relizane">48 - Relizane</option>
                                <option value="Timimoun">49 - Timimoun</option>
                                <option value="Bordj Badji Mokhtar">50 - Bordj Badji Mokhtar</option>
                                <option value="Ouled Djellal">51 - Ouled Djellal</option>
                                <option value="Beni Abbes">52 - Beni Abbes</option>
                                <option value="Ain Salah">53 - Ain Salah</option>
                                <option value="Ain Guezzam">54 - Ain Guezzam</option>
                                <option value="Touggourt">55 - Touggourt</option>
                                <option value="Djanet">56 - Djanet</option>
                                <option value="El M'Ghair">57 - El M'Ghair</option>
                                <option value="El Menia">58 - El Menia</option>
                            </select>
                            <label id="I-wilaya">Please select a wilaya</label>
                            <div class="row">
                                <div class="col-50">
                                    <label for="state">Ville</label>
                                    <input type="text" id="ville" required name="state" placeholder="Algiers">
                                    <label id="I-ville">Please enter a valide city</label>
                                </div>
                                <div class="col-50">
                                    <label for="zip">Zip</label>
                                    <input type="text" id="zip" required name="zip" placeholder="16 000">
                                    <label id="I-zip">Please enter a valide zip code</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <input type="submit" id="Submit" value="Continue to checkout" class="btn">
                </form>
            </div>
        </div>
        <div class="col-25">
            <div class="container">
                <h4>Cart <span class="price" style="color:black"><i class="fa fa-shopping-cart"></i> <b>2</b></span>
                </h4>
                <script>
                    document.addEventListener('DOMContentLoaded', function () {
                        fetchCartItems();
                    });
                    function fetchCartItems() {
                        const xhr = new XMLHttpRequest();
                        xhr.open('GET', 'Database/fetch_cart_items.php', true);
                        xhr.onload = function () {
                            if (xhr.status === 200 && xhr.readyState === 4) {
                                const data = JSON.parse(xhr.responseText);
                                const cartContainer = document.querySelector('.col-25 .container');
                                let cartHTML = '<h4>Cart <span class="price" style="color:black"><i class="fa fa-shopping-cart"></i> <b>' + data.length + '</b></span></h4>';
                                let total = 0;
                                data.forEach(item => {
                                    // Calculate the total for each product (price * quantity)
                                    const itemTotal = parseFloat(item.price) * parseInt(item.quantity);
                                    total += itemTotal;
                                    // Add the product to the cart HTML
                                    cartHTML += `
            <p>
                ${item.name} (x${item.quantity}) 
                <span class="price">$${itemTotal.toFixed(2)}</span>
            </p>
            `;
                                });
                                // Round the total to two decimal places
                                total = Math.round(total * 100) / 100;
                                // Add the total to the cart HTML
                                cartHTML += `<hr><p>Total <span class="price" style="color:black"><b>$${total.toFixed(2)}</b></span></p>`;
                                // Update the cart container with the new HTML
                                cartContainer.innerHTML = cartHTML;
                            } else {
                                console.error('Error fetching cart items.');
                            }
                        };
                        xhr.send();
                    }
                </script>
            </div>
        </div>
    </div>
</body>

</html>